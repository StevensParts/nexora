<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nexora ProSuite - Language & Location Setup</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

  <!-- Welcome Modal -->
  <div id="welcome-modal" class="modal">
    <div class="modal-content">
      <h2>üåç Welcome to Nexora ProSuite</h2>
      <p>Please select your preferences:</p>

      <label for="country">Country:</label>
      <select id="country"></select>

      <label for="language">Language:</label>
      <select id="language"></select>

      <label for="region">Region/State:</label>
      <input type="text" id="region" placeholder="Enter your region/state">

      <label for="postal">Postal Code:</label>
      <input type="text" id="postal" placeholder="Enter your postal code">

      <button id="save-preferences">Save & Continue</button>
    </div>
  </div>

  <!-- Page Content -->
  <div id="main-content" style="display:none;">
    <h1 data-translate="welcome">Welcome to Nexora ProSuite</h1>
    <p data-translate="intro">Your personalized enterprise portal experience.</p>
  </div>

  <script>
    async function loadPreferences() {
      const countrySelect = document.getElementById('country');
      const languageSelect = document.getElementById('language');

      // Fetch countries
      const countries = await fetch('assets/data/countries.json')
        .then(res => res.json());
      countries.countries.forEach(c => {
        const option = document.createElement('option');
        option.value = c.code;
        option.textContent = c.name;
        countrySelect.appendChild(option);
      });

      // Fetch languages
      const languages = await fetch('assets/data/languages.json')
        .then(res => res.json());
      languages.languages.forEach(l => {
        const option = document.createElement('option');
        option.value = l.code;
        option.textContent = l.name;
        languageSelect.appendChild(option);
      });

      // Check if preferences exist in localStorage
      const saved = JSON.parse(localStorage.getItem('nexoraPrefs'));
      if (saved) {
        countrySelect.value = saved.country || '';
        languageSelect.value = saved.language || '';
        document.getElementById('region').value = saved.region || '';
        document.getElementById('postal').value = saved.postal || '';
        applyTranslations(saved.language);
        document.getElementById('welcome-modal').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
      }
    }

    function applyTranslations(lang) {
      // Demo translations (expand later with JSON dictionaries)
      const translations = {
        es: { welcome: "Bienvenido a Nexora ProSuite", intro: "Tu portal empresarial personalizado." },
        fr: { welcome: "Bienvenue √† Nexora ProSuite", intro: "Votre portail d'entreprise personnalis√©." },
        de: { welcome: "Willkommen bei Nexora ProSuite", intro: "Ihr personalisiertes Unternehmensportal." }
      };

      document.querySelectorAll('[data-translate]').forEach(el => {
        const key = el.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
          el.textContent = translations[lang][key];
        }
      });
    }

    document.getElementById('save-preferences').addEventListener('click', () => {
      const prefs = {
        country: document.getElementById('country').value,
        language: document.getElementById('language').value,
        region: document.getElementById('region').value,
        postal: document.getElementById('postal').value
      };
      localStorage.setItem('nexoraPrefs', JSON.stringify(prefs));
      applyTranslations(prefs.language);
      document.getElementById('welcome-modal').style.display = 'none';
      document.getElementById('main-content').style.display = 'block';
    });

    loadPreferences();
  </script>
</body>
</html>
