<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#667eea">
    <title>Nexora v1.2.0 - Where Everything Connects</title>
    <!-- 
    ============================================
    NEXORA™ v1.2.0 - Premium Digital Identity Hub
    ============================================
    Now with Google Calendar Integration!
    -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .floating-shapes {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .shape {
            position: absolute;
            backdrop-filter: blur(5px);
            border-radius: 50%;
            animation: float 20s infinite ease-in-out;
        }

        .shape1 {
            width: 300px;
            height: 300px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            top: -150px;
            left: -150px;
            animation-delay: 0s;
        }

        .shape2 {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(245, 87, 108, 0.1));
            bottom: -100px;
            right: -100px;
            animation-delay: 5s;
        }

        .shape3 {
            width: 250px;
            height: 250px;
            background: linear-gradient(135deg, rgba(35, 166, 213, 0.1), rgba(35, 213, 171, 0.1));
            top: 50%;
            left: 50%;
            animation-delay: 10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(100px, -100px) rotate(90deg); }
            50% { transform: translate(-100px, 100px) rotate(180deg); }
            75% { transform: translate(-50px, -50px) rotate(270deg); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 20px 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--primary-gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-text {
            color: var(--text-primary);
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .tagline {
            color: var(--text-secondary);
            font-size: 12px;
            margin-top: 2px;
        }

        .search-bar {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            padding: 10px 20px;
            width: 300px;
            color: white;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-bar::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .search-bar:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            width: 350px;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .notification-icon, .settings-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .notification-icon:hover, .settings-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 12px 24px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--primary-gradient);
            border: none;
        }

        .nav-icon {
            font-size: 18px;
        }

        .content-area {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .stat-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.5);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .platform-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .platform-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .platform-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .platform-card:hover::before {
            opacity: 0.1;
        }

        .platform-card:hover {
            transform: translateY(-5px) scale(1.05);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .platform-icon {
            width: 60px;
            height: 60px;
            background: var(--primary-gradient);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }

        .platform-name {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .platform-status {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .welcome-section {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .welcome-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: var(--primary-gradient);
            opacity: 0.1;
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .welcome-title {
            font-size: 42px;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .welcome-subtitle {
            color: var(--text-secondary);
            font-size: 18px;
            position: relative;
            z-index: 1;
        }

        /* Calendar Styles */
        .calendar-container {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 8px 16px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-nav button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-day-header {
            text-align: center;
            color: var(--text-secondary);
            font-weight: 600;
            padding: 10px;
        }

        .calendar-day {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 10px;
            min-height: 80px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .calendar-day:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .calendar-day-number {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .calendar-day.today {
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.5);
        }

        .calendar-day.other-month {
            opacity: 0.5;
        }

        .calendar-event {
            background: var(--primary-gradient);
            border-radius: 5px;
            padding: 2px 5px;
            margin: 2px 0;
            font-size: 11px;
            color: white;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .connect-button {
            background: var(--primary-gradient);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .connect-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .events-list {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
        }

        .event-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .event-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .event-time {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .event-title {
            color: var(--text-secondary);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow);
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                padding: 15px;
            }

            .search-bar {
                width: 100%;
                max-width: 100%;
            }

            .search-bar:focus {
                width: 100%;
            }

            .welcome-title {
                font-size: 32px;
            }

            .welcome-section {
                padding: 25px 20px;
            }

            .nav-tabs {
                display: flex;
                overflow-x: auto;
                scroll-snap-type: x mandatory;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 10px;
            }

            .nav-tabs::-webkit-scrollbar {
                height: 4px;
            }

            .nav-tabs::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 2px;
            }

            .nav-tabs::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.3);
                border-radius: 2px;
            }

            .nav-tab {
                flex-shrink: 0;
                scroll-snap-align: start;
                padding: 10px 16px;
                font-size: 14px;
            }

            .calendar-grid {
                gap: 5px;
            }

            .calendar-day {
                min-height: 60px;
                padding: 5px;
            }

            .calendar-day-number {
                font-size: 14px;
            }

            .modal-content {
                width: 95%;
                margin: 20px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="floating-shapes">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
    </div>

    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">N</div>
                <div>
                    <div class="logo-text">Nexora™ <span style="font-size: 10px; opacity: 0.7; margin-left: 5px;">v1.2.0</span></div>
                    <div class="tagline">Where Everything Connects™</div>
                </div>
            </div>
            <input type="text" class="search-bar" placeholder="Search platforms, settings, security...">
            <div class="user-menu">
                <div class="notification-icon">🔔</div>
                <div class="settings-icon">⚙️</div>
            </div>
        </header>

        <nav class="nav-tabs">
            <div class="nav-tab active" onclick="showSection('dashboard', event)">
                <span class="nav-icon">🏠</span> Dashboard
            </div>
            <div class="nav-tab" onclick="showSection('calendar', event)">
                <span class="nav-icon">📅</span> Calendar
            </div>
            <div class="nav-tab" onclick="showSection('identity', event)">
                <span class="nav-icon">👤</span> Identity Hub
            </div>
            <div class="nav-tab" onclick="showSection('platforms', event)">
                <span class="nav-icon">🔗</span> Platforms
            </div>
            <div class="nav-tab" onclick="showSection('security', event)">
                <span class="nav-icon">🔒</span> Security
            </div>
            <div class="nav-tab" onclick="showSection('social', event)">
                <span class="nav-icon">💬</span> Social
            </div>
            <div class="nav-tab" onclick="showSection('productivity', event)">
                <span class="nav-icon">💼</span> Productivity
            </div>
            <div class="nav-tab" onclick="showSection('entertainment', event)">
                <span class="nav-icon">🎮</span> Entertainment
            </div>
            <div class="nav-tab" onclick="showSection('finance', event)">
                <span class="nav-icon">💳</span> Finance
            </div>
        </nav>

        <div class="content-area">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section">
                <div class="welcome-section">
                    <h1 class="welcome-title">Welcome to Nexora</h1>
                    <p class="welcome-subtitle">Your unified digital command center</p>
                </div>
                
                <div class="dashboard">
                    <div class="stat-card">
                        <div class="stat-value">142</div>
                        <div class="stat-label">Connected Platforms</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">8</div>
                        <div class="stat-label">Active Identities</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">256-bit</div>
                        <div class="stat-label">Encryption Level</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">99.9%</div>
                        <div class="stat-label">Uptime</div>
                    </div>
                </div>
            </div>

            <!-- Calendar Section -->
            <div id="calendar" class="section hidden">
                <div class="welcome-section">
                    <h1 class="welcome-title">Calendar Hub</h1>
                    <p class="welcome-subtitle">Sync all your calendars in one place</p>
                </div>

                <div id="calendar-auth" style="text-align: center; padding: 40px;">
                    <h2 style="color: var(--text-primary); margin-bottom: 20px;">Connect Your Google Calendar</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">
                        Sign in with Google to sync your events and manage your schedule
                    </p>
                    <button class="connect-button" onclick="handleAuthClick()">
                        <span>🔗</span> Connect Google Calendar
                    </button>
                </div>

                <div id="calendar-content" class="hidden">
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <div class="calendar-title" id="currentMonth">December 2024</div>
                            <div class="calendar-nav">
                                <button onclick="previousMonth()">← Previous</button>
                                <button onclick="todayMonth()">Today</button>
                                <button onclick="nextMonth()">Next →</button>
                            </div>
                        </div>
                        <div class="calendar-grid" id="calendar-grid">
                            <!-- Calendar will be generated here -->
                        </div>
                    </div>

                    <div class="events-list">
                        <h3 style="color: var(--text-primary); margin-bottom: 20px;">Upcoming Events</h3>
                        <div id="events-container">
                            <!-- Events will be loaded here -->
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="connect-button" onclick="handleSignoutClick()">
                            <span>🔌</span> Disconnect Calendar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Identity Hub Section -->
            <div id="identity" class="section hidden">
                <div class="welcome-section">
                    <h1 class="welcome-title">Identity Hub</h1>
                    <p class="welcome-subtitle">Manage all your digital identities in one secure location</p>
                </div>
                
                <div class="platform-grid">
                    <div class="platform-card" onclick="showModal('Personal Identity')">
                        <div class="platform-icon">👤</div>
                        <div class="platform-name">Personal</div>
                        <div class="platform-status">Primary • Verified</div>
                    </div>
                    <div class="platform-card" onclick="showModal('Work Identity')">
                        <div class="platform-icon">💼</div>
                        <div class="platform-name">Work</div>
                        <div class="platform-status">Active • Synced</div>
                    </div>
                    <div class="platform-card" onclick="showModal('Gaming Identity')">
                        <div class="platform-icon">🎮</div>
                        <div class="platform-name">Gaming</div>
                        <div class="platform-status">Online • Public</div>
                    </div>
                    <div class="platform-card" onclick="showModal('Creative Identity')">
                        <div class="platform-icon">🎨</div>
                        <div class="platform-name">Creative</div>
                        <div class="platform-status">Portfolio • Active</div>
                    </div>
                </div>
            </div>

            <!-- Other sections remain the same... -->
            <!-- Platforms, Security, Social, Productivity, Entertainment, Finance sections -->
            <!-- (keeping them identical to original) -->
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal()">✕</div>
            <div class="modal-header" id="modalTitle">Platform Details</div>
            <div id="modalBody">
                <p style="color: var(--text-secondary); line-height: 1.6;">
                    This platform is successfully connected to your Nexora account. 
                    All data is encrypted and synchronized across your devices.
                </p>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <!-- Google API -->
    <script src="https://apis.google.com/js/api.js"></script>

    <script>
        // ============================================
        // CONFIGURATION SECTION - ADD YOUR CREDENTIALS HERE
        // ============================================

        // ⚠️ REPLACE WITH YOUR FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "YOUR-FIREBASE-API-KEY",
            authDomain: "YOUR-PROJECT.firebaseapp.com",
            projectId: "YOUR-PROJECT-ID",
            storageBucket: "YOUR-PROJECT.appspot.com",
            messagingSenderId: "YOUR-SENDER-ID",
            appId: "YOUR-APP-ID"
        };

        // ⚠️ ADD YOUR GOOGLE CLIENT ID AND API KEY HERE
        const GOOGLE_CLIENT_ID = '500520358578-55nuva34dpk90blh088fb7dj32i87iub.apps.googleusercontent.com.apps.googleusercontent.com';
        const GOOGLE_API_KEY = AIzaSyApYmVOgMDdH81AxHH3tbG-MKL82kONUj8

        // ============================================
        // END CONFIGURATION SECTION
        // ============================================

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // Google Calendar API
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest';
        const SCOPES = 'https://www.googleapis.com/auth/calendar.readonly';

        let tokenClient;
        let gapiInited = false;
        let gisInited = false;
        let currentMonth = new Date();

        // Initialize Google API
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            await gapi.client.init({
                apiKey: GOOGLE_API_KEY,
                discoveryDocs: [DISCOVERY_DOC],
            });
            gapiInited = true;
            maybeEnableButtons();
        }

        function gisLoaded() {
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: GOOGLE_CLIENT_ID,
                scope: SCOPES,
                callback: '', // defined later
            });
            gisInited = true;
            maybeEnableButtons();
        }

        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                document.getElementById('calendar-auth').style.display = 'block';
            }
        }

        function handleAuthClick() {
            tokenClient.callback = async (resp) => {
                if (resp.error !== undefined) {
                    throw (resp);
                }
                document.getElementById('calendar-auth').style.display = 'none';
                document.getElementById('calendar-content').classList.remove('hidden');
                await loadCalendar();
            };

            if (gapi.client.getToken() === null) {
                tokenClient.requestAccessToken({prompt: 'consent'});
            } else {
                tokenClient.requestAccessToken({prompt: ''});
            }
        }

        function handleSignoutClick() {
            const token = gapi.client.getToken();
            if (token !== null) {
                google.accounts.oauth2.revoke(token.access_token);
                gapi.client.setToken('');
                document.getElementById('calendar-content').classList.add('hidden');
                document.getElementById('calendar-auth').style.display = 'block';
            }
        }

        async function loadCalendar() {
            try {
                const response = await gapi.client.calendar.events.list({
                    'calendarId': 'primary',
                    'timeMin': (new Date()).toISOString(),
                    'showDeleted': false,
                    'singleEvents': true,
                    'maxResults': 10,
                    'orderBy': 'startTime'
                });

                const events = response.result.items;
                displayEvents(events);
                generateCalendar();
            } catch (err) {
                console.error('Error loading calendar:', err);
            }
        }

        function displayEvents(events) {
            const container = document.getElementById('events-container');
            container.innerHTML = '';

            if (!events || events.length === 0) {
                container.innerHTML = '<p style="color: var(--text-secondary);">No upcoming events found.</p>';
                return;
            }

            events.forEach(event => {
                const eventDate = event.start.dateTime || event.start.date;
                const eventDiv = document.createElement('div');
                eventDiv.className = 'event-item';
                eventDiv.innerHTML = `
                    <div class="event-time">${new Date(eventDate).toLocaleString()}</div>
                    <div class="event-title">${event.summary}</div>
                `;
                container.appendChild(eventDiv);
            });
        }

        function generateCalendar() {
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const prevLastDay = new Date(year, month, 0);
            const prevDays = prevLastDay.getDate();
            const lastDate = lastDay.getDate();
            const startDay = firstDay.getDay();
            const nextDays = 7 - lastDay.getDay() - 1;

            // Update month title
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;

            // Generate calendar grid
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';

            // Day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                grid.appendChild(dayHeader);
            });

            // Previous month days
            for (let x = startDay; x > 0; x--) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day other-month';
                dayDiv.innerHTML = `<div class="calendar-day-number">${prevDays - x + 1}</div>`;
                grid.appendChild(dayDiv);
            }

            // Current month days
            const today = new Date();
            for (let i = 1; i <= lastDate; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                if (i === today.getDate() && year === today.getFullYear() && month === today.getMonth()) {
                    dayDiv.classList.add('today');
                }
                
                dayDiv.innerHTML = `<div class="calendar-day-number">${i}</div>`;
                grid.appendChild(dayDiv);
            }

            // Next month days
            for (let j = 1; j <= nextDays; j++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day other-month';
                dayDiv.innerHTML = `<div class="calendar-day-number">${j}</div>`;
                grid.appendChild(dayDiv);
            }
        }

        function previousMonth() {
            currentMonth.setMonth(currentMonth.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentMonth.setMonth(currentMonth.getMonth() + 1);
            generateCalendar();
        }

        function todayMonth() {
            currentMonth = new Date();
            generateCalendar();
        }

        // Navigation functions
        function showSection(sectionId, evt) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            document.getElementById(sectionId).classList.remove('hidden');
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            if (evt && evt.target) {
                evt.target.closest('.nav-tab').classList.add('active');
            }
        }

        function showModal(platform) {
            document.getElementById('modalTitle').textContent = platform;
            document.getElementById('modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // Load Google API on page load
        window.onload = function() {
            gapiLoaded();
            
            // Load Google Identity Services
            const script = document.createElement('script');
            script.src = 'https://accounts.google.com/gsi/client';
            script.onload = gisLoaded;
            script.async = true;
            script.defer = true;
            document.body.appendChild(script);
        };
    </script>
</body>
</html>
